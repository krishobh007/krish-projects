<section class="content current" ng-click='clearErrorMessage()'>
	<div>
		<header class="content-title float">
			<h2> Rates </h2>
			<span class="count"> ({{totalCount}}) </span>
			<a class="action add" ui-sref="admin.addRate" ng-click="showLoader()" ng-hide="isConnectedToPMS">Add new</a>

			<a class="action import" ng-click="importFromPms($event)" ng-show="isConnectedToPMS">IMPORT FROM PMS</a>

			<div class="filters">
				<div class="filter select">
					<div class="entry">
						<div class="select">
							<select class="placeholder" ng-model="filterType" ng-options="opt.name for opt in filterList">
								<option value="">Filter by Rate Type</option>						
							</select>
						</div>
					</div>

				</div>
			</div>
		</header>
		<section class="content-scroll">
			<div ng-include="'/assets/partials/common/notification_message.html'"></div>
			<div ng-include="'/assets/partials/common/notification_success_message.html'"></div>
			
			
			<span class="count-show">Show</span>
			<div class="select table-count rates-table-count">
				<select ng-model="displyCount"	ng-options="opt for opt in displayCountList"></select>
			</div>
			<span class="count-entries">entries</span>
				
			<div class="entry table-search">
				<span class="search-text">Search</span>
				<span class="icons icon-search" name="submit" type="submit"></span>
				<input placeholder="" autocomplete="off" type="text" ad-delay-textbox ng-model="searchTerm" delay="1000" function-to-fire="searchEntered" />
		    </div>
			

			<div id="new-form-holder"></div>
			<!--ng-table component -->
			<table class="grid" ng-table="tableParams" template-pagination="custom/pager" ng-class="{'edit-data': currentClickedElement == $index}">
				<tbody>
					<tr ng-repeat="rate in $data" ng-class = "{'inactive': !rate.status}"> 
						<td data-title="'Name'" sortable="'rate'" header-class="width-25" ng-hide="currentClickedElement == $index">
							<a class="edit-data" ng-click="editRatesClicked(rate.id, $index)" >
								<strong> {{rate.name}}</strong>
							</a>
						</td>

						<td data-title="'Based on'"  sortable="'based_on'" header-class="width-20" ng-hide="currentClickedElement == $index">
							<span qtip category='rateType' url='/api/rates.json?based_on_rate_id={{rate.based_on.id}}' title="Rate based on {{rate.based_on.name}}">
								{{rate.based_on.name}}
							</span>
						</td>
						<td data-title="'Type'" sortable="'rate_type'" header-class="width-15" ng-hide="currentClickedElement == $index">
							<span qtip category='rateType' url='/api/rates.json?rate_type_id={{rate.rate_type.id}}' title="{{rate.rate_type.name}}">
								<strong>{{rate.rate_type.name}}</strong>
							</span>
						</td>
						<td data-title="'Date Ranges'" header-class="width-15" class = "center_align" ng-hide="currentClickedElement == $index">
							<span ng-show="rate.date_range_count > 0" qtip title="{{rate.name}} - RATE DATE RANGES" category='dateRange' url='/api/rates/{{rate.id}}/rate_date_ranges'>
								{{rate.date_range_count}}
							</span>
							<span ng-show="rate.date_range_count == 0">
								{{rate.date_range_count}}
							</span>
						</td>
						<td data-title="'Status'" sortable="'status'" ng-class = "{'green': rate.status}" header-class="width-15" ng-hide="currentClickedElement == $index">
							<div class="entry" ng-click="toggleActive(rate.id,rate.status,rate.is_activation_allowed)">
								<div class="switch-button single" ng-class="{'on': rate.status}">
									<input type="checkbox"  ng-checked="rate.status">
									<span class="switch-icon"></span>
								</div>
							</div>
							<!-- {{rate.status ? 'ACTIVE' : 'INACTIVE'}} -->
						</td>
						<td header-class="width-10" ng-hide="currentClickedElement == $index">
							 <span class="icons delete_small cursor_pointer" ng-click="deleteRate(rate.id)" ng-hide="false">&nbsp;</span>
						</td>
						<td colspan="6" header-class="width-0" ng-include="getTemplateUrl($index, rate.id)"></td> 
					</tr>
				</tbody>
			</table>
		</section>
		<!--end -->

		<!--Custom pagination footer goes here-->
		<script type="text/ng-template" id="custom/pager">
			<div class = "pager">
				<span ng-show="totalCount>0">Showing {{startCount}} to {{endCount}} of {{totalCount}} items</span>
				<span ng-show="totalCount==0">Showing 0 items</span>
				<ul class="ng-cloak">
	              	<li ng-repeat="page in pages"
		                ng-class="{'previous': page.type == 'prev', 'next': page.type == 'next'}"
		                ng-show="page.type == 'prev' || page.type == 'next'" ng-switch="page.type">
	
		                <a ng-switch-when="prev" ng-click="params.page(1)" class="page" ng-class="{'disabled': !page.active}">First</a>
		                <a ng-switch-when="prev" ng-click="params.page(page.number)" class="page" ng-class="{'disabled': !page.active}">Previous</a>
		                <a ng-switch-when="prev" ng-click="params.page(page.number)" class="page" ng-class="{'disabled': !page.active}">{{page.number}}</a>
		                
		                <a ng-switch-when="next" ng-click="params.page(page.number)" class="page" ng-class="{'disabled': !page.active}">{{page.number}}</a>
		                <a ng-switch-when="next" ng-click="params.page(page.number)" class="page" ng-class="{'disabled': !page.active}">Next</a>
		                <a ng-switch-when="next" ng-click="params.page(totalPage)" class="page" ng-class="{'disabled': !page.active}">Last</a>
		          	</li>
	            </ul>
	        </div>
		</script>
		<!--end-->
	</div>
</section>

<div id="new-form-holder" ng-show="isAddmode" ng-include="getAddRateTemplateUrl()">

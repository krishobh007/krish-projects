<div role="dialog" id="modal" class="modal-show">
	<form id="post-charge" class="modal-content post-charge" ng-click="setPosition()" ng-cloak>
		<button type="button" id="modal-close" class="modal-close" ng-click="closeDialog()">
			<span class="icons icon-close invert"></span>
		</button>
		
		<!-- Left side -->
		<fieldset class="content-left">
			<div role="search" class="search-form">
				<div class="select">
					<select
						name="charge-groups"
						id="charge-groups"
						ng-model="chargeGroup"
						ng-change = "filterbyChargeGroup()">
						<option value="" class="placeholder" translate>ALL_CHARGE_GROUPS</option>
						<option value="FAV" translate>FAVORITE</option>
						<option ng-repeat="group in fetchedData.charge_groups" value="{{ group.value }}">
					        {{ group.name }}
					    </opzion>
					</select>
				</div>
				<div class="entry">
					<a class="icons icon-clear-search visible" href="" id="clear-query" ng-show="query" ng-click="clearQuery()">Clear query</a>
					<button type="button" name="submit" class="icons icon-search">
						Search
					</button>
					<input type="search" class="query" placeholder="{{ 'SEARCH_TERM' |translate }}" name="query" id="query" autocomplete="off" ng-model="query" ng-change="filterByQuery()">
				</div>
			</div>
			<div id="items-listing" class="scrollable" ng-iscroll="items_list">
				<ul id="search-item-results" class="wrapper">
					<li id="items-list" ng-repeat="each in fetchedItems" ng-show="each.show" ng-click="addItem(each)">
						<a class="button white">
							<span ng-bind-html="{{convertToJSONString(each.item_name)}} | highlight:query:false"></span>
							<span class="price">
								{{ currencySymbol }} <span class="value">{{ each.unit_price | number : 2 }}</span>
							</span>
							<span ng-if="each.count > 0" class="count">{{ each.count }}</span>
						</a>
					</li>
					<li id="items-list" ng-repeat="each in fetchedChargeCodes" ng-show="each.show && isResultOnFetchedChargecode" ng-click="addItem(each)">
						<a class="button white">
							<span ng-bind-html="each.description | highlight:query:false"></span>
							<span class="price">
								<span class="value" ng-bind-html="'{{ each.charge_code }}' | highlight:query:false"></span>
							</span>
							<span ng-if="each.count > 0" class="count">{{ each.count }}</span>
						</a>
					</li>
				</ul>
			</div>
		</fieldset>
		<!-- Right side -->
		<fieldset class="content-right">
			<div ng-include="'/assets/partials/common/notification_message.html'"></div>

			<span class="h2 message">
				<span translate>POST_CHARGE_TO_BILL</span> #<span ng-show="passActiveBillNo">{{ passActiveBillNo }}</span>
				<div id="select-bill-number" class="select select-stand-alone" ng-hide="passActiveBillNo || !isStandAlone">
					<select ng-model="billNumber">
					    <option ng-repeat="no in fetchedData.bill_numbers" ng-selected="{{no == billNumber}}" value="{{ no }}">
					        {{ no }}
					    </option>
					    <option value="{{fetchedData.bill_numbers.length+1}}" ng-show="fetchedData.bill_numbers.length<10 && isStandAlone">{{fetchedData.bill_numbers.length+1}} &nbsp;&nbsp;({{'NEW_BILL'|translate}})</option>
					</select>
				</div> 
				<!-- we have to replicate code as option is not being hidden in devices -->
				<div id="select-bill-number" class="select" ng-hide="passActiveBillNo || isStandAlone">
					<select ng-model="billNumber">
					    <option ng-repeat="no in fetchedData.bill_numbers" ng-selected="{{no == billNumber}}" value="{{ no }}">
					        {{ no }}
					    </option>
					</select>
				</div> 
			</span>
			<div id="no-items-added" class="no-content" ng-hide="isAnyChosen()">
				<div class="info">
					<strong class="h1" translate>0_ITEM_SELECTED</strong>
				</div>
			</div>
			<div id="items-added" ng-show="isAnyChosen()" >
				<div id="items-summary" class="scrollable" ng-iscroll="items_summary">
					
					<ul class="wrapper">
						<li ng-repeat="each in fetchedItems" ng-show="each.isChosen" ng-class="{'selected': each.item_name === selectedChargeItem.item_name}" ng-click="selectUnselect(each)">
							{{ each.item_name }}
							<span count ng-show="each.count > 1">({{ each.count }})</span>
							<span class="base">{{'AT' | translate}} {{ currencySymbol }}{{ each.modifiedPrice | number : 2 }} /  {{'UNIT' | translate}}</span>
							<span class="price">
								{{ currencySymbol }}
								<span class="value">{{ each.total_price | number : 2 }}</span>
							</span>
						</li>
						<li ng-repeat="each in fetchedChargeCodes" ng-show="each.isChosen" ng-class="{'selected': each.charge_code === selectedChargeItem.charge_code}" ng-click="selectUnselect(each)">
							{{ each.description }}
							<span count ng-show="each.count > 1">({{ each.count }})</span>
							<span class="base">at {{ currencySymbol }}{{ each.modifiedPrice | number : 2 }} /  {{'UNIT' | translate}}</span>
							<span class="price">
								{{ currencySymbol }}
								<span class="value">{{ each.total_price | number : 2 }}</span>
							</span>
						</li>
					</ul>

				</div>
				<p id="total-charge" class="offset-2">
					{{'RESV_TOTAL' | translate}} <span class="price">{{ currencySymbol }} <span class="value">{{ net_total_price | number : 2 }}</span></span>
				</p>
				<div id="numpad" ng-show="selectedChargeItem.item_name || selectedChargeItem.charge_code">
					<div id="numpad-numbers">
						<button value="1" type="button" class="button white" ng-click="calNumAction(1)">
							1
						</button>
						<button value="2" type="button" class="button white" ng-click="calNumAction(2)">
							2
						</button>
						<button value="3" type="button" class="button white" ng-click="calNumAction(3)">
							3
						</button>
						<button value="4" type="button" class="button white" ng-click="calNumAction(4)">
							4
						</button>
						<button value="5" type="button" class="button white" ng-click="calNumAction(5)">
							5
						</button>
						<button value="6" type="button" class="button white" ng-click="calNumAction(6)">
							6
						</button>
						<button value="7" type="button" class="button white" ng-click="calNumAction(7)">
							7
						</button>
						<button value="8" type="button" class="button white" ng-click="calNumAction(8)">
							8
						</button>
						<button value="9" type="button" class="button white" ng-click="calNumAction(9)">
							9
						</button>
						<button value="+/-" type="button" class="button white small" ng-click="calBtnAction('SIGN')">
							+/-
						</button>
						<button value="0" type="button" class="button white" ng-click="calNumAction(0)">
							0
						</button>
						<button value="." type="button" class="button white small" ng-click="calNumAction('.')">
							.
						</button>
					</div>
					<div id="numpad-options">
						<button value="QTY" type="button" id="quantity" class="button white numpad-toggle" ng-class="{selected: calToggle === 'QTY'}" ng-click="calBtnAction('QTY')" translate>
							QTY
						</button>
						<button value="PR" type="button" id="price" class="button white numpad-toggle"  ng-class="{selected: calToggle === 'PR'}" ng-click="calBtnAction('PR')" translate>
							PR
						</button>
						<button value="undo" type="button" class="button white with-icon only-icon clear-value" ng-click="calBtnAction('CLR')">
							<span class="icons icon-clear"></span>{{'CLEAR_LAST_VALUE' | translate}}
						</button>
						<button value="delete" type="button" class="button white with-icon only-icon remove-item" ng-click="removeItem()">
							<span class="icons icon-trash"></span>{{'REMOVE_ITEM' | translate}}
						</button>
					</div>
				</div>
				<div class="actions float">
					<button type="button" id="post" class="button green modal-close" ng-click="postCharges()" translate>POST_CHARGE</button>
					<button type="button" id="cancel" class="button blank modal-close" ng-click="closeDialog()" translate>CANCEL</button>
				</div>
			</div>
		</fieldset>
	</form>
</div>